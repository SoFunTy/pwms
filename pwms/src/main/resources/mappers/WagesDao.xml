<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yx.pwms.dao.WagesDao">
    <resultMap id="Wages" type="com.yx.pwms.entity.Wages">
        <id column="WAGES_ID" jdbcType="INTEGER" property="wagesId" />
        <result column="EMPLOYEE_ID" jdbcType="VARCHAR" property="employeeId" />
        <result column="RELEASE_TIME" jdbcType="DATE" property="releaseTime" />
        <result column="PERSION" jdbcType="DOUBLE" property="persion" />
        <result column="E_INSURANCE" jdbcType="DOUBLE" property="eInsurance" />
        <result column="I_INSURANCE" jdbcType="DOUBLE" property="iInsurance" />
        <result column="FUND" jdbcType="DOUBLE" property="fund" />
        <result column="SUBSIDY" jdbcType="DOUBLE" property="subsidy" />
        <result column="O_ADD" jdbcType="DOUBLE" property="oAdd" />
        <result column="O_BUCKLE" jdbcType="DOUBLE" property="oBuckle" />
        <result column="TOTAL" jdbcType="DOUBLE" property="total" />
    </resultMap>
    <sql id="Wages_Column_List">
     WAGES_ID,EMPLOYEE_ID, RELEASE_TIME, PERSION, E_INSURANCE, I_INSURANCE, FUND, SUBSIDY,
    O_ADD, O_BUCKLE, TOTAL
    </sql>

    <insert id="insertWages" parameterType="java.util.Map">
    insert into WAGES (EMPLOYEE_ID, RELEASE_TIME, PERSION,
      E_INSURANCE, I_INSURANCE, FUND,
      SUBSIDY, O_ADD, O_BUCKLE,
      TOTAL)
    values (#{employeeId}, #{releaseTime}, #{persion},
      #{eInsurance}, #{iInsurance}, #{fund},
      #{subsidy}, #{oAdd}, #{oBuckle},
      #{total})
     </insert>

    <delete id="deleteWages" parameterType="java.lang.Long">
    delete from WAGES
    where WAGES_ID = #{wagesId}
    </delete>

    <select id="queryMy" parameterType="java.lang.String" resultType="java.util.HashMap">
        select
        TOTAL,O_ADD,O_BUCKLE
        from WAGES
        where
         EMPLOYEE_ID = #{employeeId} and
         period_diff(date_format(curdate() , '%Y%m') , date_format(RELEASE_TIME, '%Y%m')) =1;;
    </select>

    <select id="queryList" parameterType="java.util.Map" resultMap="Wages">
        select
        <include refid="Wages_Column_List" />
        from WAGES
        where 1=1
        <if test="wagesId != null">
            AND WAGES_ID = #{wagesId}
        </if>
        <if test="employeeId != null">
            AND EMPLOYEE_ID = #{employeeId}
        </if>
        <if test="releaseTime != null">
            AND RELEASE_TIME = #{releaseTime}
        </if>
        <if test="persion != null">
            AND PERSION = #{persion}
        </if>
        <if test="eInsurance != null">
            AND E_INSURANCE = #{eInsurance}
        </if>
        <if test="iInsurance != null">
            AND I_INSURANCE = #{iInsurance}
        </if>
        <if test="fund != null">
            AND FUND = #{fund}
        </if>
        <if test="subsidy != null">
            AND SUBSIDY = #{subsidy}
        </if>
        <if test="oAdd != null">
            AND O_ADD = #{oAdd}
        </if>
        <if test="oBuckle != null">
            AND O_BUCKLE = #{oBuckle}
        </if>
        <if test="total != null">
            AND TOTAL = #{total}
        </if>
    </select>

    <update id="updateWages" parameterType="java.util.Map">
        update WAGES
        <set>
            <if test="employeeId != null">
                EMPLOYEE_ID = #{employeeId}
            </if>
            <if test="releaseTime != null">
                RELEASE_TIME = #{releaseTime},
            </if>
            <if test="persion != null">
                PERSION = #{persion},
            </if>
            <if test="eInsurance != null">
                E_INSURANCE = #{eInsurance},
            </if>
            <if test="iInsurance != null">
                I_INSURANCE = #{iInsurance},
            </if>
            <if test="fund != null">
                FUND = #{fund},
            </if>
            <if test="subsidy != null">
                SUBSIDY = #{subsidy},
            </if>
            <if test="oAdd != null">
                O_ADD = #{oAdd},
            </if>
            <if test="oBuckle != null">
                O_BUCKLE = #{oBuckle},
            </if>
            <if test="total != null">
                TOTAL = #{total},
            </if>
        </set>
        where WAGES_ID = #{wagesId},
    </update>

</mapper>